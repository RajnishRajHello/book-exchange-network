import{r as w,g as k,a as S}from"./react-D3F3s8fL.js";import{i as C,g as E,G as _,a as O,o as P,s as L,b as I,q,c as D,d as R,e as F,f as J,h as T}from"./firebase-DwTWrdd1.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var b={exports:{}},x={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j;function G(){if(j)return x;j=1;var t=w(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function n(m,l,g){var c,h={},d=null,p=null;g!==void 0&&(d=""+g),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(c in l)o.call(l,c)&&!i.hasOwnProperty(c)&&(h[c]=l[c]);if(m&&m.defaultProps)for(c in l=m.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:r,type:m,key:d,ref:p,props:h,_owner:a.current}}return x.Fragment=s,x.jsx=n,x.jsxs=n,x}var N;function U(){return N||(N=1,b.exports=G()),b.exports}var e=U(),u=w();const $=k(u);var f={},v;function M(){if(v)return f;v=1;var t=S();return f.createRoot=t.createRoot,f.hydrateRoot=t.hydrateRoot,f}var W=M();const K=k(W),z={apiKey:"AIzaSyATBmKAC9Zmylxb7bOAgHycdP8I7e7iJII",authDomain:"book-exchange-network.firebaseapp.com",projectId:"book-exchange-network",storageBucket:"book-exchange-network.firebasestorage.app",messagingSenderId:"1067589088419",appId:"1:1067589088419:web:a6cf3cc57f2c08404cbb16"},A=C(z),y=E(A),H=new _,B=O(A);function Y(){const[t,r]=u.useState(null),[s,o]=u.useState(!0);return u.useEffect(()=>{const n=P(y,m=>{r(m),o(!1)});return()=>n()},[]),{user:t,loadingAuth:s,login:async()=>{try{await I(y,H)}catch(n){console.error("Login error:",n),alert("Login failed: "+(n.message||n))}},logout:async()=>{try{await L(y)}catch(n){console.error("Sign out error:",n),alert("Sign out failed: "+(n.message||n))}}}}function Z({user:t,onLogout:r}){return e.jsxs("header",{className:"flex items-center justify-between max-w-6xl mx-auto mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:"ðŸ“š Book Exchange Network"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Campus-only listings â€¢ Be courteous when contacting owners"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-sm font-medium  text-gray-100 px-2 py-1 rounded",children:t.displayName||t.email})}),e.jsx("button",{onClick:r,className:"bg-green-600 text-white px-3 py-2 rounded hover:bg-green-900",children:"Logout"})]})]})}function Q({form:t,setForm:r,onSubmit:s}){return e.jsxs("section",{className:"bg-gray-500 shadow rounded-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 ",children:"âž• Add a Book"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{className:"border p-2 rounded",placeholder:"Book Title *",value:t.title,onChange:o=>r({...t,title:o.target.value})}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Subject",value:t.subject,onChange:o=>r({...t,subject:o.target.value})}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Semester",value:t.semester,onChange:o=>r({...t,semester:o.target.value})}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Price (or Free)",value:t.price,onChange:o=>r({...t,price:o.target.value})}),e.jsxs("div",{className:"flex items-center md:col-span-2",children:[e.jsx("span",{className:"bg-gray-200 px-3 py-2 rounded-l text-gray-700",children:"+91"}),e.jsx("input",{className:"border p-2 rounded-r flex-1",placeholder:"WhatsApp",value:t.phone,onChange:o=>r({...t,phone:o.target.value.replace(/\D/g,"")}),inputMode:"numeric"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:s,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Add Book"})})]})}function V({book:t}){const r=t.phone||"Not provided",s=t.phone?t.phone.replace(/\D/g,""):null;return`${encodeURIComponent(t.ownerEmail||"")}${encodeURIComponent("Book request: "+(t.title||""))}`,e.jsxs("div",{className:"bg-gray-600 p-4 rounded shadow-inner shadow-gray-400 border-gray-900 border",children:[e.jsxs("h3",{className:"font-bold text-lg mb-1",children:["Book: ",t.title]}),e.jsxs("p",{className:"text-gray-200 text-sm",children:["ðŸ“˜Subject: ",t.subject||"â€”"]}),e.jsxs("p",{className:"text-gray-200 text-sm",children:["ðŸŽ“Semester: ",t.semester||"â€”"]}),e.jsxs("p",{className:"text-green-500 font-semibold mt-2",children:["ðŸ’°Price: ",t.price||"Free"]}),e.jsxs("div",{className:"mt-3 text-sm text-gray-200",children:[e.jsxs("p",{children:["ðŸ“ž ",r]}),e.jsxs("p",{className:"text-gray-200",children:["Owner: ",t.ownerName||t.ownerEmail||"â€”"]})]}),e.jsx("div",{className:"mt-3 flex gap-3",children:s&&s.length>=10&&e.jsx("a",{href:`https://wa.me/${s}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 underline",children:"WhatsApp"})})]})}function X({books:t,loading:r}){return e.jsxs("section",{className:"mb-12 bg-slate-800 shadow rounded-lg p-2",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-cyan-200",children:"ðŸ“– Available Books"}),r?e.jsx("p",{className:"text-gray-600",children:"Loading books..."}):t.length===0?e.jsx("p",{className:"text-gray-600",children:"No books available yet â€” be the first to add one!"}):e.jsx("div",{className:"grid gap-6 grid-cols-2 md:grid-cols-2 lg:grid-cols-3 ",children:t.map(s=>e.jsx(V,{book:s},s.id))})]})}function ee({className:t,style:r}){const s=u.useRef(null);u.useEffect(()=>{try{(window.adsbygoogle=window.adsbygoogle||[]).push({})}catch{}},[]);const o={display:"block",height:"100px",...r};return e.jsx("div",{className:t,style:{height:"100px"},children:e.jsx("ins",{className:"adsbygoogle",style:o,"data-ad-client":"ca-pub-7265798690109951","data-ad-slot":"8134315892","data-ad-format":"auto","data-full-width-responsive":"true",ref:s})})}async function te(){const t=q(R(B,"books"),D("createdAt","desc"));return(await F(t)).docs.map(s=>({id:s.id,...s.data()}))}function re(t,r){const s=(t.phone||"").replace(/\D/g,"");if(s.length<10)throw new Error("Please enter a valid 10-digit phone number (without +91).");const a="+91"+s.slice(-10);return{title:t.title,subject:t.subject||"",semester:t.semester||"",price:t.price||"Free",phone:a,ownerEmail:r?.email||"",ownerName:r?.displayName||"",createdAt:J()}}async function se(t){await T(R(B,"books"),t)}function ae(){const{user:t,loadingAuth:r,login:s,logout:o}=Y(),[a,i]=u.useState(!1),[n,m]=u.useState([]),[l,g]=u.useState({title:"",subject:"",semester:"",price:"",phone:""});u.useEffect(()=>{t?c():m([])},[t]);const c=async()=>{i(!0);try{const d=await te();m(d)}catch(d){console.error("Error loading books:",d),alert("Failed to load books. Check console for details.")}finally{i(!1)}},h=async()=>{if(!l.title||!l.phone){alert("Please enter at least a book title and a phone number.");return}let d;try{d=re(l,t)}catch(p){alert(p.message);return}try{await se(d),g({title:"",subject:"",semester:"",price:"",phone:""}),await c()}catch(p){console.error("Error adding book:",p),alert("Failed to add book. Check console for details.")}};return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"loader mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-black p-3",children:[e.jsx(Z,{user:t,onLogout:o}),e.jsxs("main",{className:"max-w-6xl mx-auto",children:[e.jsx(Q,{form:l,setForm:g,onSubmit:h}),e.jsx(ee,{style:{margin:"1rem 0"}}),e.jsx(X,{books:n,loading:a})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-black-900 mb-4",children:"ðŸ“š Book Exchange Network"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Sign in with your Google account to start listing and browsing books."}),e.jsx("button",{onClick:s,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Sign in with Google"})]})})}K.createRoot(document.getElementById("root")).render(e.jsx($.StrictMode,{children:e.jsx(ae,{})}));
